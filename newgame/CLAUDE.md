## ğŸ§¬ ç»†èŒä»£ç åŸåˆ™ (Bacterial Code Principles)

åŸºäºç»†èŒåŸºå› ç»„çš„ç¼–ç¨‹å“²å­¦ï¼š**å°å·§ã€æ¨¡å—åŒ–ã€ç‹¬ç«‹è‡ªè¶³**

### ğŸ”¬ å°å·§åŸåˆ™ (Compact Code)
**æ¯ä¸€è¡Œä»£ç éƒ½æ¶ˆè€—èƒ½é‡ - è¿½æ±‚æè‡´ç²¾ç®€**
- **å‡½æ•°ä¸è¶…è¿‡20è¡Œ** - å¦‚åŒç»†èŒåŸºå› çš„ç´§å‡‘æ€§ï¼Œæ¯ä¸ªå‡½æ•°éƒ½åº”è¯¥å°è€Œä¸“æ³¨
- **ç±»ä¸è¶…è¿‡100è¡Œ** - ä¿æŒç±»çš„èŒè´£å•ä¸€ï¼Œé¿å…è‡ƒè‚¿çš„"ä¸Šå¸ç±»"
- **æ–‡ä»¶ä¸è¶…è¿‡300è¡Œ** - è¶…è¿‡åˆ™ç«‹å³åˆ†è§£ï¼Œå°±åƒç»†èŒåˆ†è£‚ä¸€æ ·è‡ªç„¶
- **åˆ é™¤æ­»ä»£ç ** - æœªä½¿ç”¨çš„ä»£ç å°±åƒæ— ç”¨çš„åŸºå› ç‰‡æ®µï¼Œå¿…é¡»æ¸…é™¤
- **ä¼˜å…ˆä½¿ç”¨å†…ç½®å‡½æ•°** - åˆ©ç”¨Pythonçš„å†…ç½®èƒ½åŠ›ï¼Œå‡å°‘è‡ªå®šä¹‰å®ç°
- **é¿å…é‡å¤ä»£ç ** - DRYåŸåˆ™ï¼Œæ¯ä¸ªåŠŸèƒ½åªå®ç°ä¸€æ¬¡

### ğŸ§© æ¨¡å—åŒ–åŸåˆ™ (Modular Operons)
**ä»£ç è¢«ç»„ç»‡æˆå¯ç›¸äº’æ›¿æ¢çš„"æ“çºµå­"ç¾¤ç»„**

#### ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„ (ä¸‰å¤§ä¸»æ–‡ä»¶å¤¹)
```
game_project/
â”œâ”€â”€ code/                    # ä»£ç æ–‡ä»¶å¤¹ - æ¯ä¸ªæ“çºµå­ä¸€ä¸ªæ–‡ä»¶
â”‚   â”œâ”€â”€ input_operon.py     # è¾“å…¥æ“çºµå­ (A/D/ç©ºæ ¼/E/å·¦é”®)
â”‚   â”œâ”€â”€ weapon_operon.py    # æ­¦å™¨æ“çºµå­ (4æ§½ä½ç³»ç»Ÿ)
â”‚   â”œâ”€â”€ enemy_operon.py     # æ•Œäººæ“çºµå­ (è¿œç¨‹/è¿‘æˆ˜/æŠ¤ç›¾å…µ)
â”‚   â”œâ”€â”€ npc_operon.py       # NPCæ“çºµå­ (æ­¦å™¨å•†/æŠ€èƒ½æ ‘/å•†åº—)
â”‚   â”œâ”€â”€ combat_operon.py    # æˆ˜æ–—æ“çºµå­ (æ”»å‡»/é˜²å¾¡/æŠ€èƒ½)
â”‚   â”œâ”€â”€ movement_operon.py  # ç§»åŠ¨æ“çºµå­ (è·³è·ƒ/ç¢°æ’/ç‰©ç†)
â”‚   â”œâ”€â”€ progression_operon.py # æˆé•¿æ“çºµå­ (ç»éªŒ/ç­‰çº§/æŠ€èƒ½æ ‘)
â”‚   â””â”€â”€ generation_operon.py # ç”Ÿæˆæ“çºµå­ (å…³å¡/æ•Œäºº/é“å…·)
â”œâ”€â”€ images/                  # å›¾ç‰‡æ–‡ä»¶å¤¹ - æŒ‰ç±»å‹åˆ†ç±»
â”‚   â”œâ”€â”€ characters/         # è§’è‰²å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ player/         # ä¸»è§’å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ enemies/        # æ•Œäººå›¾ç‰‡ (è¿œç¨‹/è¿‘æˆ˜/æŠ¤ç›¾å…µ)
â”‚   â”‚   â””â”€â”€ npcs/           # NPCå›¾ç‰‡ (æ­¦å™¨å•†/æŠ€èƒ½å¯¼å¸ˆ/å•†åº—)
â”‚   â”œâ”€â”€ weapons/            # æ­¦å™¨å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ main_weapons/   # ä¸»æ­¦å™¨ (å¼“ç±»/è¿‘æˆ˜æ­¦å™¨)
â”‚   â”‚   â””â”€â”€ sub_weapons/    # å‰¯æ­¦å™¨ (é“å…·/æŠ€èƒ½ç±»)
â”‚   â”œâ”€â”€ ui/                 # é¡µé¢å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ dialogs/        # å¯¹è¯æ¡†å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ hud/            # HUDå…ƒç´  (è¡€æ¡/æŠ€èƒ½æ )
â”‚   â”‚   â””â”€â”€ menus/          # èœå•ç•Œé¢å›¾ç‰‡
â”‚   â””â”€â”€ tiles/              # åœ°å›¾å›¾ç‰‡
â”‚       â”œâ”€â”€ terrain/        # åœ°å½¢ç“¦ç‰‡
â”‚       â”œâ”€â”€ objects/        # ç¯å¢ƒç‰©ä½“
â”‚       â””â”€â”€ backgrounds/    # èƒŒæ™¯å›¾ç‰‡
â””â”€â”€ maps/                   # åœ°å›¾æ–‡ä»¶å¤¹ - Tiledåœ°å›¾æ–‡ä»¶
    â”œâ”€â”€ starter_village.tmx # æ–°æ‰‹æ‘åœ°å›¾
    â”œâ”€â”€ dungeon_01.tmx      # åœ°ç‰¢å…³å¡1
    â”œâ”€â”€ dungeon_02.tmx      # åœ°ç‰¢å…³å¡2
    â””â”€â”€ boss_arena.tmx      # Bossæˆ˜æ–—åœºåœ°
```

#### ğŸ”¬ æ“çºµå­å¼æ¨¡å—è®¾è®¡
- **å•æ–‡ä»¶æ“çºµå­** - æ¯ä¸ªæ“çºµå­ç‹¬ç«‹æˆä¸€ä¸ªPythonæ–‡ä»¶
- **èµ„æºåˆ†ç¦»** - ä»£ç ä¸å›¾ç‰‡ã€åœ°å›¾å®Œå…¨åˆ†ç¦»
- **æ ‡å‡†åŒ–æ¥å£** - ç»Ÿä¸€çš„æ”»å‡»å¤„ç†ï¼šæ™®æ”»(ç‚¹å‡»)ã€æŠ€èƒ½(é•¿æŒ‰)
- **èµ„æºå¼•ç”¨** - é€šè¿‡è·¯å¾„é…ç½®å¼•ç”¨å¯¹åº”çš„å›¾ç‰‡å’Œåœ°å›¾èµ„æº
- **çƒ­æ’æ‹”èƒ½åŠ›** - å¯ä»¥è½»æ¾æ›¿æ¢ä¸åŒçš„æ­¦å™¨å’Œæ•Œäººç±»å‹
- **æœ€å°ä¾èµ–** - æ¯ä¸ªæ“çºµå­ç‹¬ç«‹è¿è¡Œï¼Œèµ„æºæŒ‰éœ€åŠ è½½

### ğŸ”„ ç‹¬ç«‹è‡ªè¶³åŸåˆ™ (Self-Sufficient Transfer)
**é€šè¿‡"æ°´å¹³åŸºå› è½¬ç§»"å¯ä»¥è½»æ¾åœ°"å¤åˆ¶ç²˜è´´"**
- **é›¶ä¾èµ–æ¨¡å—** - æ¯ä¸ªæ¨¡å—éƒ½èƒ½ç‹¬ç«‹è¿è¡Œå’Œæµ‹è¯•
- **æ ‡å‡†åŒ–æ¥å£** - ä½¿ç”¨ç»Ÿä¸€çš„æ•°æ®ç»“æ„å’Œé€šä¿¡åè®®
- **é…ç½®é©±åŠ¨** - é€šè¿‡é…ç½®æ–‡ä»¶è€Œéç¡¬ç¼–ç æ¥æ§åˆ¶è¡Œä¸º
- **æ’ä»¶æ¶æ„** - æ–°åŠŸèƒ½å¯ä»¥ä½œä¸ºæ’ä»¶ç›´æ¥"è½¬ç§»"åˆ°ç³»ç»Ÿä¸­
- **æ–‡æ¡£å®Œå¤‡** - æ¯ä¸ªæ¨¡å—éƒ½æœ‰å®Œæ•´çš„ä½¿ç”¨è¯´æ˜ï¼Œä¾¿äº"è½¬ç§»"
- **ç¤ºä¾‹ä»£ç ** - æä¾›å¯ç›´æ¥è¿è¡Œçš„ç¤ºä¾‹ï¼Œé™ä½é›†æˆæˆæœ¬

### ğŸ”„ é¡¹ç›®æ„è¯†ä¸ä¸Šä¸‹æ–‡
- **å§‹ç»ˆé˜…è¯» `PLANNING.md`** äº†è§£é¡¹ç›®çš„"åŸºå› å›¾è°±"
- **æ£€æŸ¥ `TASK.md`** ç¡®ä¿æ¯ä¸ªä»»åŠ¡éƒ½æ˜¯å¿…è¦çš„"åŸºå› è¡¨è¾¾"
- **éµå¾ªç»†èŒå¼æ¶æ„** - å°è€Œç¾çš„ç»„ä»¶åŒ–è®¾è®¡
- **èƒ½é‡æ•ˆç‡ä¼˜å…ˆ** - æ¯è¡Œä»£ç éƒ½è¦æœ‰æ˜ç¡®çš„ä»·å€¼

### ğŸ§ª æµ‹è¯•ä¸å¯é æ€§
- **å¾®æµ‹è¯•ç­–ç•¥** - æ¯ä¸ªå°å‡½æ•°éƒ½æœ‰å¯¹åº”çš„å°æµ‹è¯•
- **æ“çºµå­æµ‹è¯•** - æ¯ä¸ªæ¨¡å—ç¾¤ç»„éƒ½æœ‰é›†æˆæµ‹è¯•
- **è½¬ç§»æµ‹è¯•** - éªŒè¯æ¨¡å—å¯ä»¥åœ¨ä¸åŒç¯å¢ƒä¸­æ­£å¸¸å·¥ä½œ
- **èƒ½é‡æ¶ˆè€—æµ‹è¯•** - æ€§èƒ½æµ‹è¯•ç¡®ä¿ä»£ç æ•ˆç‡

### âœ… ä»»åŠ¡å®Œæˆ
- **åŸå­åŒ–ä»»åŠ¡** - æ¯ä¸ªä»»åŠ¡éƒ½åƒå•ä¸ªåŸºå› ä¸€æ ·å°è€Œå®Œæ•´
- **å¿«é€Ÿè¿­ä»£** - åƒç»†èŒç¹æ®–ä¸€æ ·å¿«é€Ÿå®Œæˆå°ä»»åŠ¡
- **æŒç»­è¿›åŒ–** - é€šè¿‡å°æ­¥éª¤ä¸æ–­æ”¹è¿›ç³»ç»Ÿ

### ğŸ“ ç»†èŒå¼ç¼–ç é£æ ¼
```python
# å°å·§ï¼šå•ä¸€èŒè´£çš„å¾®å‡½æ•°
def calc_damage(base: int, mult: float) -> int:
    """è®¡ç®—ä¼¤å®³ - å•ä¸€èŒè´£ï¼Œæç®€å®ç°"""
    return int(base * mult)

# è¾“å…¥æ§åˆ¶æ“çºµå­ - æ ‡å‡†åŒ–çš„ç©å®¶è¾“å…¥å¤„ç†
class InputOperon:
    """è¾“å…¥æ“çºµå­ - å¤„ç†æ‰€æœ‰ç©å®¶è¾“å…¥"""
    def __init__(self):
        self.keys = {
            'move_left': pygame.K_a,      # Aé”®å‘å·¦
            'move_right': pygame.K_d,     # Dé”®å‘å³  
            'jump': pygame.K_SPACE,       # ç©ºæ ¼è·³è·ƒ
            'interact': pygame.K_e        # Eé”®äº¤äº’
        }
        self.mouse = {
            'attack': 0  # å·¦é”®æ”»å‡» (pygame.BUTTON_LEFT)
        }
    
    def handle_movement(self, keys_pressed) -> tuple:
        """å¤„ç†ç§»åŠ¨è¾“å…¥ - è¿”å›(xæ–¹å‘, æ˜¯å¦è·³è·ƒ)"""
        x_dir = 0
        if keys_pressed[self.keys['move_left']]:
            x_dir = -1
        if keys_pressed[self.keys['move_right']]: 
            x_dir = 1
        jump = keys_pressed[self.keys['jump']]
        return x_dir, jump
    
    def handle_action(self, mouse_pressed, keys_pressed) -> dict:
        """å¤„ç†åŠ¨ä½œè¾“å…¥ - è¿”å›åŠ¨ä½œå­—å…¸"""
        return {
            'attack': mouse_pressed[self.mouse['attack']],
            'interact': keys_pressed[self.keys['interact']]
        }

# æ­¦å™¨ç³»ç»Ÿæ“çºµå­ - 4æ§½ä½æ­¦å™¨ç®¡ç†
class WeaponOperon:
    """æ­¦å™¨æ“çºµå­ - ç®¡ç†4ä¸ªæ­¦å™¨æ§½ä½"""
    def __init__(self):
        self.slots = {
            'main_1': None,    # ä¸»æ­¦å™¨1 (å¼“/è¿‘æˆ˜)
            'main_2': None,    # ä¸»æ­¦å™¨2 (å¼“/è¿‘æˆ˜)
            'sub_1': None,     # å‰¯æ­¦å™¨1 (é“å…·/æŠ€èƒ½)
            'sub_2': None      # å‰¯æ­¦å™¨2 (é“å…·/æŠ€èƒ½)
        }
        self.current_slot = 'main_1'
    
    def attack(self, is_skill: bool) -> dict:
        """æ‰§è¡Œæ”»å‡» - æ™®æ”»æˆ–æŠ€èƒ½"""
        weapon = self.slots[self.current_slot]
        if not weapon: return None
        return weapon.skill_attack() if is_skill else weapon.normal_attack()

# æ•Œäººç³»ç»Ÿæ“çºµå­ - ä¸‰ç§æ•Œäººç±»å‹
class EnemyOperon:
    """æ•Œäººæ“çºµå­ - ç®¡ç†ä¸‰ç§æ•Œäººç±»å‹"""
    def create_enemy(self, enemy_type: str):
        """åˆ›å»ºæ•Œäºº - å·¥å‚æ¨¡å¼"""
        types = {
            'ranged': self._create_ranged,    # è¿œç¨‹æ•Œäºº
            'melee': self._create_melee,      # è¿‘æˆ˜æ•Œäºº  
            'shield': self._create_shield     # æŠ¤ç›¾å…µ
        }
        return types[enemy_type]()

# NPCç³»ç»Ÿæ“çºµå­ - æ–°æ‰‹æ‘NPC
class NPCOperon:
    """NPCæ“çºµå­ - æ–°æ‰‹æ‘åŠŸèƒ½NPC"""
    def __init__(self):
        self.npcs = {
            'weapon_dealer': self._weapon_npc,     # åˆå§‹æ­¦å™¨NPC
            'skill_trainer': self._skill_npc,      # æŠ€èƒ½æ ‘NPC
            'upgrade_shop': self._upgrade_npc      # æ°¸ä¹…æå‡å•†åº—
        }

# èµ„æºç®¡ç†æ“çºµå­ - ç»Ÿä¸€èµ„æºåŠ è½½
class ResourceOperon:
    """èµ„æºæ“çºµå­ - ç®¡ç†å›¾ç‰‡å’Œåœ°å›¾èµ„æº"""
    def __init__(self):
        self.base_paths = {
            'characters': 'images/characters/',
            'weapons': 'images/weapons/',
            'ui': 'images/ui/',
            'tiles': 'images/tiles/',
            'maps': 'maps/'
        }
    
    def load_character(self, char_type: str, name: str):
        """åŠ è½½è§’è‰²å›¾ç‰‡ - ç»Ÿä¸€æ¥å£"""
        path = f"{self.base_paths['characters']}{char_type}/{name}.png"
        return pygame.image.load(path)
    
    def load_weapon(self, weapon_type: str, name: str):
        """åŠ è½½æ­¦å™¨å›¾ç‰‡ - ç»Ÿä¸€æ¥å£"""
        path = f"{self.base_paths['weapons']}{weapon_type}/{name}.png"
        return pygame.image.load(path)

# ç‹¬ç«‹è‡ªè¶³ï¼šå¯ç›´æ¥è½¬ç§»çš„æ¨¡å—
def create_game_systems():
    """å·¥å‚å‡½æ•° - åˆ›å»ºæ‰€æœ‰æ¸¸æˆç³»ç»Ÿ"""
    return {
        'input': InputOperon(),
        'weapon': WeaponOperon(), 
        'enemy': EnemyOperon(),
        'npc': NPCOperon(),
        'resource': ResourceOperon()
    }
```

### ğŸ“š æ–‡æ¡£ä¸è¿›åŒ–
- **åŸºå› æ³¨é‡Š** - æ¯ä¸ªå‡½æ•°éƒ½è¦è¯´æ˜å…¶"ç”Ÿç‰©å­¦åŠŸèƒ½"
- **è¿›åŒ–æ—¥å¿—** - è®°å½•ä»£ç çš„æ¼”åŒ–è¿‡ç¨‹
- **è½¬ç§»æŒ‡å—** - è¯¦ç»†è¯´æ˜å¦‚ä½•å°†æ¨¡å—è½¬ç§»åˆ°å…¶ä»–é¡¹ç›®

### ğŸ§  ç»†èŒå¼AIè¡Œä¸º
- **èƒ½é‡å®ˆæ’** - ä¸å†™æ— ç”¨ä»£ç ï¼Œä¸åšæ— æ•ˆè®¡ç®—
- **å¿«é€Ÿé€‚åº”** - æ ¹æ®ç¯å¢ƒå¿«é€Ÿè°ƒæ•´ä»£ç ç»“æ„
- **æ°´å¹³å­¦ä¹ ** - ä»å…¶ä»–é¡¹ç›®"è½¬ç§»"æœ‰ç”¨çš„ä»£ç æ¨¡å¼
- **æŒç»­åˆ†è£‚** - å¤§æ¨¡å—è‡ªåŠ¨åˆ†è§£ä¸ºå°æ¨¡å—